<div class="game-container">
  @if (triviaService.isUsingFallback()) {
    <div class="api-limit-banner">
      ‚ö†Ô∏è API limit reached. Using pre-generated riddles for this session.
    </div>
  }
  
  <div class="game-header">
    <div class="header-info">
      <h1>{{ triviaService.triviaState().category }}</h1>
      <span class="difficulty-badge" [style.background-color]="getDifficultyBadgeColor()">
        {{ triviaService.triviaState().difficulty | titlecase }}
      </span>
    </div>
    
    <div class="score-display">
      <span class="score-label">Score:</span>
      <span class="score-value">{{ triviaService.triviaState().score }}</span>
    </div>
  </div>

  <div class="progress-section">
    <div class="progress-text">
      Question {{ triviaService.progress().current }} of {{ triviaService.progress().total }}
    </div>
    <div class="progress-bar">
      <div 
        class="progress-fill" 
        [style.width.%]="(triviaService.progress().current / triviaService.progress().total) * 100"
      ></div>
    </div>
  </div>

  @if (triviaService.currentQuestion(); as question) {
    <div class="question-section">
      <h2 class="question-text">{{ question.question }}</h2>
      <p class="points-info">{{ question.points }} points</p>
    </div>

    <div class="answers-section">
      @for (answer of triviaService.currentQuestionAnswers(); track answer) {
        <button
          class="answer-btn"
          [class.selected]="selectedAnswer() === answer"
          [class.correct]="isAnswerCorrect(answer)"
          [class.wrong]="isAnswerWrong(answer)"
          [disabled]="showResult()"
          (click)="selectAnswer(answer)"
        >
          <span class="answer-text">{{ answer }}</span>
          @if (showResult() && isAnswerCorrect(answer)) {
            <span class="result-icon">‚úì</span>
          }
          @if (showResult() && isAnswerWrong(answer)) {
            <span class="result-icon">‚úó</span>
          }
        </button>
      }
    </div>

    @if (showResult()) {
      <div class="feedback-section" [class.correct]="isCorrect()" [class.incorrect]="!isCorrect()">
        <div class="feedback-header">
          @if (isCorrect()) {
            <span class="feedback-icon">üéâ</span>
            <h3>Correct!</h3>
          } @else {
            <span class="feedback-icon">üòî</span>
            <h3>Incorrect</h3>
          }
        </div>
        
        @if (isCorrect()) {
          <p class="points-feedback">+{{ pointsEarned() }} points!</p>
        } @else {
          <p class="correct-answer">Correct answer: <strong>{{ question.correctAnswer }}</strong></p>
        }
        
        @if (question.explanation) {
          <p class="explanation">{{ question.explanation }}</p>
        }
      </div>
    }

    <div class="action-buttons">
      @if (!showResult()) {
        <button
          class="submit-btn"
          [disabled]="!canSubmit()"
          (click)="submitAnswer()"
        >
          Submit Answer
        </button>
      } @else {
        <button
          class="next-btn"
          (click)="nextQuestion()"
        >
          {{ getButtonText() }}
        </button>
      }
    </div>
  }
</div>

